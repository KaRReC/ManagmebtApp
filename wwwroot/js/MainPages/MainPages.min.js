import{HttpRequest,UserInfo,GetModalTxt,GetLocation}from"../Modules/AxiosModule.js";import{GetWordTranslation,GetTxtById}from"../Translations.js";import{Button,Modal,ModalClass,ButtonClass,IconClass}from"../Modules/ModalModule.js";const Page=GetLocation.GetPage(),Area=GetLocation.GetArea();switch(Page){case"Welcome":const r=$("#Input_DontShow"),s=$("#SendCoupons"),u=$(".coupons");function h(n){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)}let n,t,f,e,o;function i(n=[]){return Promise.all(n).then(n=>n)}$(document).ready(function(){UserInfo("LanguageInfo").then(r=>{if(r==!1){const r=new Promise(r=>{let u=sessionStorage.getItem("language");var s=[GetTxtById(27,u),GetModalTxt("LanguageInfo",u),GetTxtById(32,u),GetTxtById(33,u)];r(i(s).then(i=>{n=i[0],t=i[1].bodyTitle,f=i[1].bodyInfo,e=i[2],o=i[3]}))});r.then(()=>{const i=new Button("ConfirmButton",ButtonClass.success,e),r=new Button("NoButton",ButtonClass.Error,o);var u=[i,r];const s=new Modal("#Modal",ModalClass.Info,IconClass.Info,n,t,f,u);s.init();i.listen(`${Area}/${Page}?handler=UserConfirm`,"LanguageInfo",!0)})}});r.click(function(){let n=this.checked;if(n==!0){let t=`${Area}/${Page}?handler=DontShow`,i={check:n};HttpRequest.get(t,{params:i}).then(function(n){n.data==!0?$(".CouponsContent").hide("slow"):r.click()}).catch(function(n){console.log(n)})}});s.click(function(){var e,o;let r=$("#Input_Email"),f=sessionStorage.getItem("language");const s=new Button("ConfirmButton",ButtonClass.Info,"OK");if(e=[s],(r.val()==null||r.val()==undefined)&&r.val(""),r.val()!="")if(h(r.val()))if(o=[],u.each(function(){this.checked==!0&&o.push({IdCoupon:this.id.replace("Coupon_","")})}),o.length==0){const r=new Promise(r=>{var u=[GetTxtById(27,f),GetTxtById(37,f)];r(i(u).then(i=>{n=i[0],t=i[1]}))});r.then(()=>{const i=new Modal("#Modal",ModalClass.Info,IconClass.Info,n,t,"",e);i.init()})}else HttpRequest.post(`${Area}/${Page}?handler=SendCoupon`,{email:r.val(),Coupons:o}).then(function(o){let s=o.data.message;if(o.data.status==!1){const r=new Promise(r=>{var u=[GetTxtById(25,f)];r(i(u).then(i=>{n=i[0]+" !",t=s}))});r.then(()=>{const i=new Modal("#Modal",ModalClass.Error,IconClass.Error,n,t,"",e);i.init()})}else{const o=new Promise(r=>{var u=[GetTxtById(27,f)];r(i(u).then(i=>{n=i[0],t=s}))});o.then(()=>{const i=new Modal("#Modal",ModalClass.Info,IconClass.Info,n,t,"",e);i.init()});u.each(function(){this.checked==!0&&(this.checked=!1)});r.val("")}}).catch(function(n){console.log(n)});else{const u=new Promise(u=>{var e=[GetTxtById(25,f),GetTxtById(15,f),GetWordTranslation("is not valid")];u(i(e).then(i=>{n=i[0]+" !",t=i[1]+" : <span class='text-danger'>"+r.val()+"<\/span> "+i[2]+" !"}))});u.then(()=>{const i=new Modal("#Modal",ModalClass.Error,IconClass.Error,n,t,"",e);i.init()})}})});break;case"":break;default:"No code"}